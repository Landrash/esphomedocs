<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><meta http-equiv="X-UA-Compatible"content="IE=Edge"><meta http-equiv="Content-Type"content="text/html; charset=utf-8"><title>Sensor Component &#8212; esphomelib 1.5.3 documentation</title><link rel="stylesheet"href="../../../_static/alabaster.css"type="text/css"><link rel="stylesheet"href="../../../_static/pygments.css"type="text/css"><script src="../../../_static/documentation_options.js"></script><script src="../../../_static/jquery.js"></script><script src="../../../_static/underscore.js"></script><script src="../../../_static/doctools.js"></script><link rel="index"title="Index"href="../../../genindex.html"><link rel="search"title="Search"href="../../../search.html"><link rel="stylesheet"href="../../../_static/custom.css"type="text/css"><meta name="viewport"content="width=device-width,initial-scale=0.9,maximum-scale=0.9"><div class="document"><div class="documentwrapper"><div class="bodywrapper"><div class="body"role="main"><div class="section"id="sensor-component"><h1>Sensor Component<a class="headerlink"href="#sensor-component"title="Permalink to this headline">¶</a></h1><p>esphomelib has support for many different sensors. Each of them is a platform of the <code class="docutils literal notranslate"><span class="pre">sensor</span></code> domain and each sensor has several base configuration options.<div class="section"id="base-sensor-configuration"><h2>Base Sensor Configuration<a class="headerlink"href="#base-sensor-configuration"title="Permalink to this headline">¶</a></h2><p>All sensors in esphomeyaml/esphomelib have a name and some other optional configuration options. By default, the sensor platform will chose appropriate values for all of these by default, but you can always override them if you want to.<div class="code yaml highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example sensor configuration</span>
<span class="n">name</span><span class="p">:</span> <span class="n">Livingroom</span> <span class="n">Temperature</span>

<span class="c1"># Optional variables:</span>
<span class="n">unit_of_measurement</span><span class="p">:</span> <span class="s2">&quot;°C&quot;</span>
<span class="n">icon</span><span class="p">:</span> <span class="s2">&quot;mdi:water-percent&quot;</span>
<span class="n">accuracy_decimals</span><span class="p">:</span> <span class="mi">1</span>
<span class="n">expire_after</span><span class="p">:</span> <span class="mi">30</span><span class="n">s</span>
<span class="n">filters</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">sliding_window_moving_average</span><span class="p">:</span>
      <span class="n">window_size</span><span class="p">:</span> <span class="mi">15</span>
      <span class="n">send_every</span><span class="p">:</span> <span class="mi">15</span>
</pre></div></div><p>Configuration variables:<ul class="simple"><li><strong>name</strong> (<strong>Required</strong>, string): The name for the sensor.<li><strong>unit_of_measurement</strong> (<em>Optional</em>, string): Manually set the unit of measurement the sensor should advertise its values with. This does not actually do any maths (conversion between units).<li><strong>icon</strong> (<em>Optional</em>, icon): Manually set the icon to use for the sensor in the frontend.<li><strong>accuracy_decimals</strong> (<em>Optional</em>, int): Manually set the accuracy of decimals to use when reporting values.<li><strong>expire_after</strong> (<em>Optional</em>, <a class="reference external"href="/esphomeyaml/configuration-types.html#time">time</a>): Manually set the time in which the sensor values should be marked as “expired”/“unknown”. Not providing any value means no expiry.<li><strong>filters</strong> (<em>Optional</em>): Specify filters to use for some basic transforming of values. Defaults to a basic sliding window moving average over the last few values. See <a class="reference external"href="#sensor-filters">Sensor Filters</a> for more information.<li>All other options from <a class="reference external"href="/esphomeyaml/components/mqtt.html#mqtt-component-base-configuration">MQTT Component</a>.</ul></div><div class="section"id="sensor-filters"><h2>Sensor Filters<a class="headerlink"href="#sensor-filters"title="Permalink to this headline">¶</a></h2><p>esphomeyaml/esphomelib allow you to do some basic preprocessing of sensor values before they’re sent to Home Assistant. This is for example useful if you want to apply some average over the last few values to relief Home Assistant’s state machine and keep the history graphs in the front-end a bit more clean. More sophisticated filters should be done with Home Assistant <a class="reference external"href="https://www.home-assistant.io/components/sensor.filter/">filter sensor</a>.<div class="code yaml highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example filters:</span>
<span class="n">filters</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">offset</span><span class="p">:</span> <span class="mf">2.0</span>
  <span class="o">-</span> <span class="n">multiply</span><span class="p">:</span> <span class="mf">1.2</span>
  <span class="o">-</span> <span class="n">filter_out</span><span class="p">:</span> <span class="mf">42.0</span>
  <span class="o">-</span> <span class="n">filter_nan</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">sliding_window_moving_average</span><span class="p">:</span>
      <span class="n">window_size</span><span class="p">:</span> <span class="mi">15</span>
      <span class="n">send_every</span><span class="p">:</span> <span class="mi">15</span>
  <span class="o">-</span> <span class="n">exponential_moving_average</span><span class="p">:</span>
      <span class="n">alpha</span><span class="p">:</span> <span class="mf">0.1</span>
      <span class="n">send_every</span><span class="p">:</span> <span class="mi">15</span>
  <span class="o">-</span> <span class="n">throttle</span><span class="p">:</span> <span class="mi">1</span><span class="n">s</span>
  <span class="o">-</span> <span class="n">heartbeat</span><span class="p">:</span> <span class="mi">5</span><span class="n">s</span>
  <span class="o">-</span> <span class="n">debounce</span><span class="p">:</span> <span class="mf">0.1</span><span class="n">s</span>
  <span class="o">-</span> <span class="n">delta</span><span class="p">:</span> <span class="mf">5.0</span>
  <span class="o">-</span> <span class="n">unique</span><span class="p">:</span>
  <span class="o">-</span> <span class="ow">or</span><span class="p">:</span>
    <span class="o">-</span> <span class="n">throttle</span><span class="p">:</span> <span class="mi">1</span><span class="n">s</span>
    <span class="o">-</span> <span class="n">delta</span><span class="p">:</span> <span class="mf">5.0</span>
  <span class="o">-</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="mf">9.0</span><span class="o">/</span><span class="mf">5.0</span><span class="p">)</span> <span class="o">+</span> <span class="mf">32.0</span>
</pre></div></div><p>Above example configuration entry is probably a bit useless, but shows every filter there is currently:<ul class="simple"><li><strong>offset</strong>: Add an offset to every sensor value.<li><strong>multiply</strong>: Multiply each sensor value by this number.<li><strong>filter_out</strong>: Remove every sensor value that equals this number.<li><strong>filter_nan</strong>: Remove every value that is considered <code class="docutils literal notranslate"><span class="pre">NAN</span></code> (not a number) in C.<li><strong>sliding_window_moving_average</strong>: A <a class="reference external"href="https://en.wikipedia.org/wiki/Moving_average#Simple_moving_average">simple moving average</a> over the last few values.<ul><li><strong>window_size</strong>: The number of values over which to perform an average when pushing out a value.<li><strong>send_every</strong>: How often a sensor value should be pushed out. For example, in above configuration the weighted average is only pushed out on every 15th received sensor value.</ul><li><strong>exponential_moving_average</strong>: A simple <a class="reference external"href="https://en.wikipedia.org/wiki/Moving_average#Exponential_moving_average">exponential moving average</a> over the last few values.<ul><li><strong>alpha</strong>: The forget factor/alpha value of the filter.<li><strong>send_every</strong>: How often a sensor value should be pushed out.</ul><li><strong>throttle</strong>: Throttle the incoming values. When this filter gets an incoming value, it checks if the last incoming value is at least <code class="docutils literal notranslate"><span class="pre">specified</span> <span class="pre">time</span> <span class="pre">period</span></code> old. If it is not older than the configured value, the value is not passed forward.<li><strong>heartbeat</strong>: Send the last value that this sensor in the specified time interval. So a value of <code class="docutils literal notranslate"><span class="pre">10s</span></code> will cause the filter to output values every 10s regardless of the input values.<li><strong>debounce</strong>: Only send values if the last incoming value is at least <code class="docutils literal notranslate"><span class="pre">specified</span> <span class="pre">time</span> <span class="pre">period</span></code> old. For example if two values come in at almost the same time, this filter will only output the last value and only after the specified time period has passed without any new incoming values.<li><strong>delta</strong>: This filter stores the last value passed through this filter and only passes incoming values through if the absolute difference is greater than the configured value. For example if a value of 1.0 first comes in, it’s passed on. If the delta filter is configured with a value of 5, it will now not pass on an incoming value of 2.0, only values that are at least 6.0 big or -4.0.<li><strong>unique</strong>: This filter has no parameter and does one very simple thing: It only passes forward values if they are different from the last one that got through the pipeline.<li><strong>or</strong>: Pass forward a value with the first child filter that returns. Above example will only pass forward values that are <em>either</em> at least 1s old or are if the absolute difference is at least 5.0.<li><strong>lambda</strong>: Perform a simple mathematical operation over the sensor values. The input value is <code class="docutils literal notranslate"><span class="pre">x</span></code> and the result of the lambda is used as output. Each floating point operation should have <code class="docutils literal notranslate"><span class="pre">.0</span></code> attached as in above configuration. This will be copied over to the C++ code as a raw string.</ul><div class="section"id="example-converting-celsius-to-fahrenheit"><h3>Example: Converting Celsius to Fahrenheit<a class="headerlink"href="#example-converting-celsius-to-fahrenheit"title="Permalink to this headline">¶</a></h3><p>While I personally don’t like the Fahrenheit temperature scale, I do understand that having temperature values appear in the fahrenheit unit is quite useful to some users. esphomelib uses the celsius temperature unit internally, and I’m not planning on making converting between the two simple (😉), but you can use this filter to convert celsius values to fahrenheit.<div class="code yaml highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">filters</span><span class="p">:</span>
  <span class="o">-</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="mf">9.0</span><span class="o">/</span><span class="mf">5.0</span><span class="p">)</span> <span class="o">+</span> <span class="mf">32.0</span>
<span class="n">unit_of_measurement</span><span class="p">:</span> <span class="s2">&quot;°F&quot;</span>
</pre></div></div></div><div class="section"id="full-sensor-index"><h3>Full Sensor Index<a class="headerlink"href="#full-sensor-index"title="Permalink to this headline">¶</a></h3><div class="toctree-wrapper compound"><ul><li class="toctree-l1"><a class="reference internal"href="dallas.html">Dallas Temperature Sensor</a><li class="toctree-l1"><a class="reference internal"href="adc.html">Analog To Digital Sensor</a><li class="toctree-l1"><a class="reference internal"href="ads1115.html">ADS1115 Sensor</a><li class="toctree-l1"><a class="reference internal"href="bmp085.html">BMP085 Temperature+Pressure Sensor</a><li class="toctree-l1"><a class="reference internal"href="dht.html">DHT Temperature+Humidity Sensor</a><li class="toctree-l1"><a class="reference internal"href="hdc1080.html">HDC1080 Temperature+Humidity Sensor</a><li class="toctree-l1"><a class="reference internal"href="htu21d.html">HTU21D Temperature+Humidity Sensor</a><li class="toctree-l1"><a class="reference internal"href="pulse_counter.html">ESP32 Pulse Counter Sensor</a><li class="toctree-l1"><a class="reference internal"href="ultrasonic.html">Ultrasonic Distance Sensor</a><li class="toctree-l1"><a class="reference internal"href="mpu6050.html">MPU6050 Accelerometer/Gyroscope Sensor</a><li class="toctree-l1"><a class="reference internal"href="bh1750.html">BH1750 Ambient Light Sensor</a><li class="toctree-l1"><a class="reference internal"href="bme280.html">BME280 Temperature+Pressure+Humidity Sensor</a><li class="toctree-l1"><a class="reference internal"href="bme680.html">BME680 Temperature+Pressure+Humidity+Gas Sensor</a><li class="toctree-l1"><a class="reference internal"href="tsl2561.html">TSL2561 Ambient Light Sensor</a><li class="toctree-l1"><a class="reference internal"href="sht3xd.html">SHT3X-D Temperature+Humidity Sensor</a><li class="toctree-l1"><a class="reference internal"href="dht12.html">DHT12 Temperature+Humidity Sensor</a><li class="toctree-l1"><a class="reference internal"href="rotary_encoder.html">Rotary Encoder Sensor</a></ul></div></div></div></div></div></div></div><div class="sphinxsidebar"role="navigation"aria-label="main navigation"><div class="sphinxsidebarwrapper"><div class="relations"><h3>Related Topics</h3><ul><li><a href="../../../index.html">Documentation overview</a><ul></ul></ul></div><div id="searchbox"style="display: none"role="search"><h3>Quick search</h3><div class="searchformwrapper"><form class="search"action="../../../search.html"><input name="q"> <input type="submit"value="Go"> <input type="hidden"name="check_keywords"value="yes"> <input type="hidden"name="area"value="default"></form></div></div><script>$('#searchbox').show(0);</script></div></div><div class="clearer"></div></div><div class="footer">&copy;2018, Otto Winter. | Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.2</a> &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a> | <a href="../../../_sources/esphomeyaml/components/sensor/index.rst.txt"rel="nofollow">Page source</a></div>